package  {	import flash.display.MovieClip;	import flash.display.Loader;	import flash.net.URLRequest;	import flash.events.Event	import flash.events.IOErrorEvent;	import flash.events.MouseEvent		import flash.errors.IOError;	import flash.display.Bitmap;	/* photo class */	public class Photo extends MovieClip  {		public static var rimNum=3;		public static var bottomHei:Number=20;		private var src:String;		private var th:String;		private var title:String;		public var id:uint						private var thLoader:Loader;				private var bigLoader:Loader;		private var bigIsLoaded:Boolean;				public var _width,_height;				public var oriRotation:Number		public function Photo(obj) {						src=obj.src;			th=obj.th;			title=obj.title;			id=obj.id;						cacheAsBitmap=true;					}		/*load thumb*/		public function loadTh(){			thLoader=new Loader();			thLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,thLoaded)			thLoader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR,thError)			thLoader.load(new URLRequest(th))		}				var bm				/*Thumb loaded event complete handler*/		private function thLoaded(e:Event):void{			 			var bmd=Bitmap(e.target.loader.content).bitmapData			 bm=new Bitmap(bmd);			bm.smoothing=true;			Loader(e.target.loader).unload();			cmc.addChild(bm);			cmc.x=rimNum,cmc.y=rimNum;			_width=bm.width+rimNum*2,_height=bm.height+rimNum*2+bottomHei;			rim.width=_width ;			rim.height=_height ;									_txt.x=rimNum			_txt.y=rim.height-bottomHei			_txt.autoSize="left";			_txt.text=title;			dispatchEvent(new Event("thLoaded"));			loadBig();		}		//error handlers		private function thError(e:IOErrorEvent):void		{			trace("thumb error")		}		private function bigError(e:IOErrorEvent):void{			trace("load big image error");		}		/*//load big image*/		public function loadBig():void{			if(!src){				return			}						var loader:Loader=new Loader();			loader.contentLoaderInfo.addEventListener(Event.COMPLETE,bigLoaded)			loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR,function(e){})			loader.load(new URLRequest(src));		}				/*big image loaded handler*/		private function bigLoaded(e):void{			var _bm=new Bitmap(e.target.loader.content.bitmapData);			Loader(e.target.loader).unload();			_bm.smoothing=true;			_bm.width=bm.width;			_bm.height=bm.height			cmc.addChild(_bm);			cmc.removeChild(bm);		}	}	}